C51 COMPILER V7.08   KEYPAD1                                                               10/02/2015 11:25:08 PAGE 1   


C51 COMPILER V7.08, COMPILATION OF MODULE KEYPAD1
OBJECT MODULE PLACED IN C:\v14he8k6\HEX\keypad1.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE keypad1.c BROWSE DEBUG OBJECTEXTEND OBJECT(C:\v14he8k6\HEX\keypad1.obj)

line level    source

   1          #include<reg51.h>
   2          #include"headers.h"
   3          sbit c0=P3^0; sbit r0=P3^4;
   4          sbit c1=P3^1; sbit r1=P3^5;
   5          sbit c2=P3^2; sbit r2=P3^6;
   6          sbit c3=P3^3; sbit r3=P3^7;
   7          code unsigned char keypad_lut[4][4]={1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16};
   8          
   9          bit colscan(void)
  10          {
  11   1        return(c0&c1&c2&c3);
  12   1      }
  13          void init_rows(void)
  14          {
  15   1      
  16   1        r0=r1=r2=r3=0;
  17   1      }
  18          void init_cols(void)
  19          {
  20   1        c0=c1=c2=c3=1;
  21   1      }
  22          unsigned char keyscan(void)
  23          {
  24   1        unsigned char row,col;
  25   1        init_cols();
  26   1        init_rows();
  27   1        while(colscan());//identify key presss
  28   1        //identify key press
  29   1        //identify row
  30   1        r0=0;r1=r2=r3=1;
  31   1        if(!colscan())
  32   1        {
  33   2          row=0;goto colcheck;
  34   2        }
  35   1        r1=0;r0=r2=r3=1;
  36   1        if(!colscan())
  37   1         {
  38   2          row=1;goto colcheck;
  39   2         }
  40   1         r2=0;r0=r1=r3=1;
  41   1        if(!colscan())
  42   1         {
  43   2          row=2;goto colcheck;
  44   2         }
  45   1         r3=0;r0=r1=r2=1;
  46   1        if(!colscan())
  47   1         {
  48   2          row=3;goto colcheck;
  49   2         }
  50   1         colcheck:
  51   1               if(c0==0)  col=0;
  52   1              else if(c1==0)  col=1;
  53   1              else if(c2==0)  col=2;
  54   1              else if(c3==0)  col=3;
  55   1              return keypad_lut[row][col];
C51 COMPILER V7.08   KEYPAD1                                                               10/02/2015 11:25:08 PAGE 2   

  56   1      
  57   1      }
  58          main()
  59          {
  60   1      unsigned int ch,i; 
  61   1      while(1)
  62   1        {
  63   2          ch=keyscan();       // read key val save in to var
  64   2              P2=ch^0x0f;  // var valu pass in to al&ah leds
  65   2              for(i=255;i>0;i--)
  66   2              displ_mux_seg(ch);
  67   2         }
  68   1      
  69   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    205    ----
   CONSTANT SIZE    =     16    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
